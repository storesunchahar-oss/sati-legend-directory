<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SATI Legends Directory</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: #f7f7f7;
  }
  h1 {
    text-align: center;
    color: #333;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }
  th, td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ddd;
  }
  tr:nth-child(even) {
    background-color: #f2f2f2;
  }
  th {
    background-color: #4CAF50;
    color: white;
    cursor: pointer;
  }
  img {
    max-width: 80px;
    max-height: 80px;
    border-radius: 5px;
  }
  input[type="text"] {
    margin-bottom: 10px;
    padding: 8px;
    width: 100%;
    max-width: 400px;
  }
</style>
</head>
<body>

<h1>SATI Legends Directory</h1>
<input type="text" id="searchInput" placeholder="Search...">

<table id="directoryTable">
  <thead>
    <tr>
      <th onclick="sortTable(0)">Name</th>
      <th onclick="sortTable(1)">Admission Year</th>
      <th onclick="sortTable(2)">Branch</th>
      <th onclick="sortTable(3)">Mobile No</th>
      <th onclick="sortTable(4)">Alternate No</th>
      <th onclick="sortTable(5)">Email</th>
      <th onclick="sortTable(6)">Present Address</th>
      <th onclick="sortTable(7)">Permanent Address</th>
      <th onclick="sortTable(8)">Occupation</th>
      <th onclick="sortTable(9)">Designation</th>
      <th onclick="sortTable(10)">Organization</th>
      <th onclick="sortTable(11)">Comments</th>
      <th>Photo</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.4/tabletop.min.js"></script>
<script>
const publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQCh-Of3P8jsxmkVSyHM2fMgbdKx2a2WUGj8Gd8pmsS9fI_bATBZl2UQGYR7PKK85TFfWb0yOuEUEhI/pubhtml?gid=129790930&single=true';

function init() {
  Tabletop.init({
    key: publicSpreadsheetUrl,
    simpleSheet: true,
    callback: showInfo
  });
}

function showInfo(data, tabletop) {
  const tbody = document.querySelector('#directoryTable tbody');
  data.forEach(row => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${row.Name || ''}</td>
      <td>${row['Admission Year'] || ''}</td>
      <td>${row.Branch || ''}</td>
      <td>${row['Mobile No'] || ''}</td>
      <td>${row['Alternate No'] || ''}</td>
      <td>${row.Email || ''}</td>
      <td>${row['Present Address'] || ''}</td>
      <td>${row['Permanent Address'] || ''}</td>
      <td>${row.Occupation || ''}</td>
      <td>${row.Designation || ''}</td>
      <td>${row.Organization || ''}</td>
      <td>${row.Comments || ''}</td>
      <td>${row.Photo ? `<img src="${row.Photo}" />` : ''}</td>
    `;
    tbody.appendChild(tr);
  });
}

// Simple search
document.getElementById('searchInput').addEventListener('keyup', function() {
  const filter = this.value.toLowerCase();
  const rows = document.querySelectorAll('#directoryTable tbody tr');
  rows.forEach(row => {
    const text = row.textContent.toLowerCase();
    row.style.display = text.includes(filter) ? '' : 'none';
  });
});

// Simple sorting
function sortTable(n) {
  const table = document.getElementById("directoryTable");
  let switching = true;
  let dir = "asc";
  while (switching) {
    switching = false;
    const rows = table.rows;
    for (let i = 1; i < rows.length - 1; i++) {
      let shouldSwitch = false;
      let x = rows[i].getElementsByTagName("TD")[n];
      let y = rows[i + 1].getElementsByTagName("TD")[n];
      if (dir == "asc") {
        if (x.textContent.toLowerCase() > y.textContent.toLowerCase()) { shouldSwitch = true; break; }
      } else if (dir == "desc") {
        if (x.textContent.toLowerCase() < y.textContent.toLowerCase()) { shouldSwitch = true; break; }
      }
    }
    if (shouldSwitch) {
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
    } else {
      if (dir == "asc") { dir = "desc"; switching = true; }
    }
  }
}

window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
